/***********************************

// ==UserScript==
// @ScriptName        酷我音乐[ VIP+净化 ]
// @Author            @ddgksf2013
// @TgChannel         https://t.me/ddgksf2021
// @Contribute        https://t.me/ddgksf2013_bot
// @Feedback          📮 ddgksf2013@163.com 📮
// @UpdateTime        2024-09-13
// @Attention         使用中若有问题请发邮件！
// @Suitable          自行观看"# > "注释内容
// @Attention         如需引用请注明出处，谢谢合作！
// @Version           V2.0.45
// @ScriptURL         https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
// ==/UserScript==


1、本重写仅限本人使用，严禁传播或售卖
2、解锁VIP歌曲，VIP听书，VIP装扮
3、全面净化去除酷我音乐广告
4、脚本工作原理为音源替换而非破解
5、若需要更高音质请付费支持歌手
6、若酷我播放发热，请关闭广告终结者Anti分流


[rewrite_local]

# > 通用广告请求@ddgksf2013
https?:\/\/vip1\.kuwo\.cn\/vip\/activity\/kwMemberDay url reject-200
# > 屏蔽热词@ddgksf2013
https?:\/\/hotword\.kuwo\.cn\/hotword\.s url reject-200
# > 通用广告请求@ddgksf2013
https?:\/\/vip1\.kuwo\.cn\/vip_adv\/ url reject-200
# > 通用广告请求@ddgksf2013
https?:\/\/wapi\.kuwo\.cn\/openapi\/v1\/app\/pasterAdvert url reject-200
# > 应用内弹窗及右下角@ddgksf2013
^https?:\/\/mobilead\.kuwo\.cn\/ url reject-200
# > 搜索框处理@ddgksf2013
https?:\/\/searchrecterm\.kuwo\.cn\/recterm\.s url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 会员页广告@ddgksf2013
https?:\/\/appi\.kuwo\.cn\/kuwopay\/vip-tab\/page\/cells url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 会员页顶部广告tab@ddgksf2013
https?:\/\/appi\.kuwo\.cn\/kuwopay\/vip-tab\/setting url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 开屏广告@ddgksf2013
https?:\/\/rich\.kuwo\.cn\/AdService url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 数字专辑@ddgksf2013
^https?:\/\/musicpay\.kuwo\.cn\/music\.pay\?newver url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 听书权限接口1@ddgksf2013
^https?:\/\/[a-z0-9A-Z]+\.(kuwo|lrts)\.(cn|me)\/a\.p url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 听书权限接口2@ddgksf2013
^https?:\/\/.*\.kuwo\.cn\/v2\/api\/pay\/vip\/extraVipStatus url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 新版vip接口1@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/enc\/user\/vip\?op=ui url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 新版vip接口2@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/v2\/userbase\/vip\?op=get url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 旧版vip接口@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/v2\/user\/vip\?(uid|op=ui) url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 皮肤解锁@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/v2\/theme url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 下载接口@ddgksf2013
^https?:\/\/musicpay\.kuwo\.cn\/music\.pay\?ui url script-request-header https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 我的页面卡片@ddgksf2013
^https?:\/\/appi.kuwo.cn/kuwopay/personal/cells url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js
# > 音乐播放接口@ddgksf2013
^https:\/\/[a-z0-9A-Z]+\.kuwo\.cn\/mobi\.s\?f=kwxs url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/kuwomusic.vip.js


[mitm]

hostname = *.kuwo.cn, *.lrts.me

***********************************/



const version = 'V1.0.14';

const $ = new Env("KW");
var _0xodR='jsjiami.com.v7';var _0x8f45a0=_0x1363;(function(_0xd5c16f,_0x5e1d09,_0x3b04a8,_0x491643,_0xe20f66,_0x7499a6,_0x3e834c){return _0xd5c16f=_0xd5c16f>>0x5,_0x7499a6='hs',_0x3e834c='hs',function(_0x33cf52,_0x2bfc80,_0x57e1ed,_0x109a32,_0x2a1d6d){var _0x5ba09c=_0x1363;_0x109a32='tfi',_0x7499a6=_0x109a32+_0x7499a6,_0x2a1d6d='up',_0x3e834c+=_0x2a1d6d,_0x7499a6=_0x57e1ed(_0x7499a6),_0x3e834c=_0x57e1ed(_0x3e834c),_0x57e1ed=0x0;var _0xf2a42d=_0x33cf52();while(!![]&&--_0x491643+_0x2bfc80){try{_0x109a32=-parseInt(_0x5ba09c(0x1fa,'D&Jk'))/0x1+parseInt(_0x5ba09c(0x192,'Ab76'))/0x2+-parseInt(_0x5ba09c(0x158,'Ab76'))/0x3+-parseInt(_0x5ba09c(0x222,'50uK'))/0x4*(parseInt(_0x5ba09c(0x1db,'fhc*'))/0x5)+parseInt(_0x5ba09c(0x209,'R)6B'))/0x6+parseInt(_0x5ba09c(0x1a1,'jBja'))/0x7+parseInt(_0x5ba09c(0x20d,'R$1l'))/0x8*(-parseInt(_0x5ba09c(0x200,'9teR'))/0x9);}catch(_0x414948){_0x109a32=_0x57e1ed;}finally{_0x2a1d6d=_0xf2a42d[_0x7499a6]();if(_0xd5c16f<=_0x491643)_0x57e1ed?_0xe20f66?_0x109a32=_0x2a1d6d:_0xe20f66=_0x2a1d6d:_0x57e1ed=_0x2a1d6d;else{if(_0x57e1ed==_0xe20f66['replace'](/[KGnfRVlAPtJMNXdxYph=]/g,'')){if(_0x109a32===_0x2bfc80){_0xf2a42d['un'+_0x7499a6](_0x2a1d6d);break;}_0xf2a42d[_0x3e834c](_0x2a1d6d);}}}}}(_0x3b04a8,_0x5e1d09,function(_0x1b2e53,_0x2ed262,_0x1b2a00,_0x54ae18,_0x22a908,_0x1f2fa6,_0x51afee){return _0x2ed262='\x73\x70\x6c\x69\x74',_0x1b2e53=arguments[0x0],_0x1b2e53=_0x1b2e53[_0x2ed262](''),_0x1b2a00='\x72\x65\x76\x65\x72\x73\x65',_0x1b2e53=_0x1b2e53[_0x1b2a00]('\x76'),_0x54ae18='\x6a\x6f\x69\x6e',(0x1824af,_0x1b2e53[_0x54ae18](''));});}(0x1780,0xabf80,_0x3761,0xbe),_0x3761)&&(_0xodR=0x20e5);function _0x3761(){var _0x3203be=(function(){return[_0xodR,'nAjnstJpjhilflaYdmRhdiPxK.XMcGoVMmVK.Nv7==','W5xcQb3dVCkBr8kg','W6LXWQxdPW4','lSkaxa','W7usWPrCW54','WRj0WQrCldldQMS2q2Tc','b8kXvCowW6e','aCkQtmkgW4elEwalqG','dCo9n8o/WRZcHCosoa','W6WHWQVcQW','W5NdSSk/WRq','E8ktW74Yd3VcGa','W5SYW6e','WRJdRNNdUSkNW6WbW7RdVYJdTSkzWO0cW7JdKq','lCobm8k+za','W4KqcL5IW5BcS8kM','W7vEELZdOSoLWPi','jmooW7GZq1BdL8oguCooWOHzwr3dRtddImkuW5rTm3P1jq','W6JdVCoWWPGTWOfsWRHhWRFdMSk9W60','WQVdJxfG','cdvEW4e9h8o6W5fDWPpJG6NOHkFNLO/LNz8','WP1SWRSa','W4/cUqhcI2JdOSotpmktW6xcUmkqWO4CWRbCtMlcO2m3WPS','WQRcKSodcCo+xLVdKmohySoeBNrs','lmoIW5ZdQmoDWQK','W4lcM8kEWQO','W73cKmoa','kCkMW7hdRCkz','W7WOWRRcPa','W4GgWP3cKq','WOKGsmoKW6a','W7iQW7vwiW','WQJdPuxcJa','g8ojWRpcV8k4','tmoulW3cHSoAWPlcU8kbs8kp','W58uEa','ASk4WOBcTmkkW6uEWPdcPCkJrYC','WRVcI8oFWRldK8oNW4CmW69sWPNdIxi','rNVcI0lcLWKXgmkcW6HCWP8','W64pWQ4','yX3dNgFdNq','BSoqpIxcHmo8WOJcVCk4','W60CWQ5aW4SA','lYfEW5q','W6ZdR8kbWOG','W4hcLmoWEG','W5xcKSoKDSku','W4xdM8om','W5pcM8kuWRtcIq','W6xdTCksWP4SWRhdHeBdId1Iv8oKW5VdMYRdJSkKbCoSW4dcNGu','nCoJW5tdPmogWP8m','W7RcH8oCcCo2xKC','W79dW70KWR0epa','Ex7dMtldOtK','W6JcJmoltSkiWQZcQub+W7z9','WQ7dQ1xcLa','oSk9WOlcSd7cIG','WRf9iLO','W65pjulcUCk3W5ddJNu','WQRdM2DM','WQHwzvldQSkOWOq','lSopl8kQCG','WRRdN2bZ','WRvWWQjDldJcVfm+FMT9W6q','WQbmq0HzW7DZW40IjxRcICktWQHlWPiZW73dK8o1WPddHYLoWPu','l8o7W5NdSq','WONcUg7dV8kO','E8k0uSkFWP4','zhdcJW','WQfwu11sWOi6','W4SJWP/dNSk7','W7VcH8oye8o2uq','e8oOsrZdQ8kgd8kxhZNdT8o6'].concat((function(){return['oCkDvmo+','W6VdMSkBW6m','y8ocbce','W6hcJmopcCoIwuFdLW','W7xcKSoKqmkCWQ3cPa','WPLnwqOLWOpdO8kIWPNcMg85WQq','DwpcL28','W7r7WQ7dPd/cIGmCW5G','W5dcLCkiWQdcNW','W5KqASoeWQpcVgm','qCkXde0','zN7dNtBdRZ49','W5HKfNhdUG','W75dW6W6WR8pk25HWO8dWOtdVmo7v0NcOSkJnmkPW7q','W7DWp1BcO33cISo2nmkBDSoPW5a','W6PdW7K+WR0l','dCktdSowkmoJoqxdJ8kblfpcJSkz','WQZdOSkkWOq7WRJdItBdId1IwmkQWOS','DSo2A8ovsYVdUa','WRNdOhtdMNyPbJ1sobBdTau','fCkxdSow','WPL3WP3dTSkLzmoczG','iSkaW4JdISk9','WOiobvnUW5pcTmk5WQ3dJr9D','WOJdL2rrmSouWQy','nYJdRMJdIM1G','WO1MWQ8vWRpdRgG','WQ5kzvS','gx4CWPjcW6hdII3cVa','ix0XWRzzW7xdIIJcJSkpna','W6xcJSkRWPBcSG','W7FdRg/dTSoXWRWBWQNcU27cQ8khW5DA','WRZdKxbR','WPRcQKa9','l8klqmoI','jSoJFSolqYFdUCodW4qOcmkU','W5lcVWe','WOFdISkQ','WRHQWRldSbJdGvXk','fCk/W4/dJCkPW7e','W6xcPddcMJuJgsilzuFcO1ddT8ofW77cNvtcTmkra8o9W7nPwSoIW4DnWRaGsW7cRxSeW6ldOmoRW5JdOSk7WOvTamkuW5JdN2ufeJ3dICkhW5/dHSobof3dNgtcOf1VWRVcN2XBW68','fCkXW5hdL8kV','n8oPWQxcI8kw','BmoNB8ojwxlcSSooWPD0wmo4W6LHsKlcGGZdHwPUFqNcHCk6W4NdRXHSjqZcHNxcKmkPxMbnBmkakGHUobvuECoYWPeswrPwWPZdIXWSzSoAAvhcICotWRlcQxa7WRy','W5S2WPNdLmk9qmotELS','W64WW7mEBf3dPu0','WRH6WQtdTXpcKq8FW4pcV8oCmhi','WP7cVgJdGCkIWQRcK8oB','WQXzq1K','uCk/k1JcOCoBlmkJ','W7mQW6uhCa','fCkSwmom','WPnQWQWn','W5JdUCkT','qSkyW7FdRmoGWRXcW5iYW7ZdTh7cSq','kw7cGvFdMJVdSa','W6FdJ8kBW7lcKmoTW5GtWQTmW4tcNg1Oie5fWOzXW7pcSKFcOa','j8owm8ouW6CCuCkdWOn9d8kZWRi','e2KHWRfJ','Cmo8smonwchdS8kg','s8k/lKxcOW','WRNdVLpcNbOTWR3dV8kV','p8opjCk0','idFcLuxdVZ/dShu','WPFdI8kKm8onW6/dSbmfWQm0AJi','W4tcLCkoWRi','W5WXWP7dLa','WRJdR1hcMruPWRe','W59Ai3S','WP3cUgJdRq','osvAW5KWgCo5','nCkfBmoeW7W','WR5NWQKCWQddU0/dS8ocevT0','W7NcTtFcNG'].concat((function(){return['nmkxrxFdHSkAW4lcN8kbzSkCcbK','W67cI8oaeCoYtW','W50uDSoDWQFcRa','WQzOjflcPg7cHCoIka','WRXYmL7cSKBcIG','W5hcPb3dNSkmqCkrWQ1cW4PKW5NdG1NcLSkDlW','umols8ktsCk7EupcI8o8EGtdIq','WOJcQLGPWOPC','W6/cVYdcKW','6iAa5PYY5yAg6lA55lYc55El772Q5Pwo6lAs6kY85lUa5OQV772c','hCorWRBcU8k/','wNVcIKxcRq','omoIW57dPa','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','DNtdIsm','zGddNNVdMHxcKMTP','y2FcK2ldQb/dRq','ECkwx8oWwmkkw8kltbZcPmkt','WPVcTNJdTq','e8oLtHNdP8khnSkSiIVdNmo8','m8oFjmokWP4','W4/cTrlcJYFdQSod','WOpdHColW6ldI8oVWP0','omoSW4tdOa','W6NdU3VdT8oX','WOZdQCoaCCowvIL5W60qW4zJwa','WQNcV8kS','WOxcVqhdSmkdvSkkWPLpW581WQBcIG','lSoOW4ddRCoFWRmp','ACoGFa','lSk3WPJcOsW','W4ZcQCkhl8knaNLyW58','vCkXcL/cTG','W4HhkW','jmofWQTNtWdcQ8kLgmkQW5Cl','W4pcOGpdTa','WQVdJhG','aSorWRFcUq','W7ldPKpcRcCnWQW','cmk3W5VdJmoKW7S','nmk2WPlcOYFcQCkN','WQ3dIMz7pCobWQTBW5W','W7ZdONVdQSoGWQq','W5rBi2FdIt7dIq','CCoHDW','mhOGWRDv','W67cOmkoWQxcIW','rCkyW7yXfKBcGW','sgGbWO5lW67dLXtcS8kdpCoue2jUW6FdG8kvWQ/dQmkFFSkjkqRcHMS','jSoJDmovqYVdPmodW4qO','WONdOfldK3BcUCkwE8omW7VdQ8ooWPe','n8ktq8oZzSkesCkswxpdSComnWS','shxcNe8','W6RcTta','WOddVwpcNHi','eSojWRpcVq','W7WibWGAW71SW5j/oYhdJmou','W4NdQSk1W6C','k8kXWOBcKIBcLSkKyG','eIpdGqpdSeuuhSkJWOqpW7G','W4pcRbNdSa','CSorha','Fmkkz8kv','WOLCqv1yWRKEWOmHzxtcJG','WRnDCvVdS8keWOC','W6DvwfPdW6mV','lclcLg/cTMuuWOBcOmopWQpcRW','cCkgcCosc8k2zL/dI8oIlLJdLCkvW5FcKNWsWQW7WPZdU0a','WPFcPva5WPDGWOe','W7TpW70CWQuxphG','WO8gDdtcIelcN8kMW5ZcHaOOWOa','uCk1c1G'];}()));}()));}());_0x3761=function(){return _0x3203be;};return _0x3761();};function _0x1363(_0x241570,_0x2e11db){var _0x3761e6=_0x3761();return _0x1363=function(_0x1363b8,_0x277bdf){_0x1363b8=_0x1363b8-0x14c;var _0x35d048=_0x3761e6[_0x1363b8];if(_0x1363['meTVHX']===undefined){var _0x5b7611=function(_0x220cbc){var _0x59a225='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x20bc73='',_0x3c2fc6='';for(var _0x4791a2=0x0,_0x17f6c6,_0x363d5d,_0x42c178=0x0;_0x363d5d=_0x220cbc['charAt'](_0x42c178++);~_0x363d5d&&(_0x17f6c6=_0x4791a2%0x4?_0x17f6c6*0x40+_0x363d5d:_0x363d5d,_0x4791a2++%0x4)?_0x20bc73+=String['fromCharCode'](0xff&_0x17f6c6>>(-0x2*_0x4791a2&0x6)):0x0){_0x363d5d=_0x59a225['indexOf'](_0x363d5d);}for(var _0x23ce14=0x0,_0x197f45=_0x20bc73['length'];_0x23ce14<_0x197f45;_0x23ce14++){_0x3c2fc6+='%'+('00'+_0x20bc73['charCodeAt'](_0x23ce14)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3c2fc6);};var _0x17836c=function(_0x3e5e01,_0x228e14){var _0x432d22=[],_0x1e458c=0x0,_0x34abdb,_0xed1988='';_0x3e5e01=_0x5b7611(_0x3e5e01);var _0x28c85e;for(_0x28c85e=0x0;_0x28c85e<0x100;_0x28c85e++){_0x432d22[_0x28c85e]=_0x28c85e;}for(_0x28c85e=0x0;_0x28c85e<0x100;_0x28c85e++){_0x1e458c=(_0x1e458c+_0x432d22[_0x28c85e]+_0x228e14['charCodeAt'](_0x28c85e%_0x228e14['length']))%0x100,_0x34abdb=_0x432d22[_0x28c85e],_0x432d22[_0x28c85e]=_0x432d22[_0x1e458c],_0x432d22[_0x1e458c]=_0x34abdb;}_0x28c85e=0x0,_0x1e458c=0x0;for(var _0x498fce=0x0;_0x498fce<_0x3e5e01['length'];_0x498fce++){_0x28c85e=(_0x28c85e+0x1)%0x100,_0x1e458c=(_0x1e458c+_0x432d22[_0x28c85e])%0x100,_0x34abdb=_0x432d22[_0x28c85e],_0x432d22[_0x28c85e]=_0x432d22[_0x1e458c],_0x432d22[_0x1e458c]=_0x34abdb,_0xed1988+=String['fromCharCode'](_0x3e5e01['charCodeAt'](_0x498fce)^_0x432d22[(_0x432d22[_0x28c85e]+_0x432d22[_0x1e458c])%0x100]);}return _0xed1988;};_0x1363['EPuOjO']=_0x17836c,_0x241570=arguments,_0x1363['meTVHX']=!![];}var _0x132c10=_0x3761e6[0x0],_0x265ecb=_0x1363b8+_0x132c10,_0x3d1fdf=_0x241570[_0x265ecb];return!_0x3d1fdf?(_0x1363['wJHMbo']===undefined&&(_0x1363['wJHMbo']=!![]),_0x35d048=_0x1363['EPuOjO'](_0x35d048,_0x277bdf),_0x241570[_0x265ecb]=_0x35d048):_0x35d048=_0x3d1fdf,_0x35d048;},_0x1363(_0x241570,_0x2e11db);}let method=$request[_0x8f45a0(0x188,'TYs!')];function showMonthlyPopup(){var _0x2d7c53=_0x8f45a0,_0xcfb520={'GPknw':_0x2d7c53(0x167,'DiJ5'),'NTCID':_0x2d7c53(0x1ef,'XMwu'),'JwBkf':'https://t.me/ddgksf2021'};const _0x5e31e3=new Date()[_0x2d7c53(0x1cb,'bQZm')](),_0x4af951=$[_0x2d7c53(0x18b,'iMOc')](_0x2d7c53(0x1ac,'S6Rz'));(_0x4af951===null||_0x4af951!=_0x5e31e3)&&($[_0x2d7c53(0x204,'O86&')](_0xcfb520[_0x2d7c53(0x1b2,'73oH')],'',_0xcfb520['NTCID'],{'open-url':_0xcfb520[_0x2d7c53(0x21d,'R$1l')]}),$[_0x2d7c53(0x19a,'@jt&')](_0x5e31e3[_0x2d7c53(0x1cd,'D&Jk')](),_0x2d7c53(0x21a,'6lH7')));}if($request[_0x8f45a0(0x208,'^n))')][_0x8f45a0(0x185,'KY8I')](_0x8f45a0(0x14d,'E^dv'))!==-0x1)(async()=>{var _0x46b03d=_0x8f45a0,_0x32d35f={'SreRM':function(_0x150990,_0x4ff7b0){return _0x150990==_0x4ff7b0;},'HKcaJ':_0x46b03d(0x1b4,'DBpK'),'EzQEH':function(_0x19a115,_0x2c9b8f){return _0x19a115!=_0x2c9b8f;},'LvRIS':function(_0x13ff8a,_0xd1402f){return _0x13ff8a===_0xd1402f;},'jDmtv':_0x46b03d(0x1d6,'gI4P'),'jfMTi':_0x46b03d(0x1c6,'*ja7'),'kyqgo':_0x46b03d(0x175,'Ex7['),'BFPqx':function(_0x105a58,_0x4463ca){return _0x105a58+_0x4463ca;},'qCfYB':function(_0x549e87){return _0x549e87();}},_0x6105f3=$response[_0x46b03d(0x16c,'2F2i')],_0x49845f=$[_0x46b03d(0x1ab,'JmJV')](_0x32d35f['kyqgo']);await $['http'][_0x46b03d(0x21c,'iivQ')]({'url':_0x32d35f[_0x46b03d(0x1e3,'1g43')]('https://mobi.kuwo.cn/mobi.s?f=web&source=kwplayer_ar_5.1.0.0_B_jiakong_vh.apk&type=convert_url_with_sign&format=mp3&rid=',_0x49845f)})[_0x46b03d(0x15c,'ySfQ')](_0x5d1515=>{var _0x2965e2=_0x46b03d,_0x1b307d={'NTtvq':function(_0x1bf035,_0x18c437){var _0x34280f=_0x1363;return _0x32d35f[_0x34280f(0x1ba,'2F2i')](_0x1bf035,_0x18c437);}};if(_0x32d35f[_0x2965e2(0x16e,'73oH')](_0x32d35f['jDmtv'],_0x32d35f['jfMTi'])){var _0x3fa1ef=_0x2965e2(0x18d,'&Nd1')['split']('|'),_0x5cba18=0x0;while(!![]){switch(_0x3fa1ef[_0x5cba18++]){case'0':var _0x2c1c2c=_0x40f288[_0x2965e2(0x207,'D&Jk')](_0x25b5b2);continue;case'1':if(_0x2c1c2c['data']&&_0x32d35f['SreRM'](_0x2c1c2c[_0x2965e2(0x1fe,'KY8I')][0x0]?.[_0x2965e2(0x1be,'6lH7')],_0x32d35f[_0x2965e2(0x1fb,'ss1P')]))_0x2c1c2c[_0x2965e2(0x1cc,'E^dv')][0x0][_0x2965e2(0x1bd,'YHH)')][_0x2965e2(0x1d8,'D&Jk')]=[_0x2965e2(0x14f,'S6Rz')];continue;case'2':_0x2c1c2c['data']=_0x530255[_0x2965e2(0x1ed,'YHH)')](_0x2c1c2c[_0x2965e2(0x1dd,'2F2i')])[_0x2965e2(0x211,'q@y%')](_0xac2056=>{var _0x4f5127=_0x2965e2;if(_0xac2056['type']!=_0x4f5127(0x226,'E^dv')&&_0x1b307d[_0x4f5127(0x215,'2F2i')](_0xac2056['type'],'Welfare'))return!![];else return![];});continue;case'3':_0x25b5b2=_0x5cdbe8[_0x2965e2(0x206,'9teR')](_0x2c1c2c);continue;case'4':var _0x25b5b2=_0x42263b[_0x2965e2(0x1cf,'1g43')];continue;}break;}}else _0x6105f3=_0x5d1515['body'];}),$['setdata']('',_0x32d35f[_0x46b03d(0x1f0,'*ja7')]),_0x32d35f['qCfYB'](showMonthlyPopup),$[_0x46b03d(0x20a,'vfqe')]({'body':_0x6105f3});})()[_0x8f45a0(0x199,'wbK$')](_0x493641=>console['log']('error:\x20'+_0x493641));else{if(/a\.p/['test']($request[_0x8f45a0(0x197,'fhc*')])){var tTdHPM='0|2|1|3|4|5'[_0x8f45a0(0x1ff,'q@y%')]('|'),TVyFzF=0x0;while(!![]){switch(tTdHPM[TVyFzF++]){case'0':var body=$response[_0x8f45a0(0x1f5,'TYs!')];continue;case'1':var id=match?match[0x1]:null;continue;case'2':var match=body[_0x8f45a0(0x174,'*ja7')](/id":(\d+)/);continue;case'3':id&&$['setval'](id,_0x8f45a0(0x189,'u!Q%'));continue;case'4':id=$response[_0x8f45a0(0x225,'NWpK')][_0x8f45a0(0x1df,'R$1l')](/.*?\"id\":(\d+).*/,'$1');continue;case'5':body=$response[_0x8f45a0(0x1e0,'^n))')][_0x8f45a0(0x186,'@jt&')](/"type":\d*/g,_0x8f45a0(0x1c2,'XMwu'))[_0x8f45a0(0x18f,'&Nd1')](/"end":\d*/g,_0x8f45a0(0x160,'q@y%'))[_0x8f45a0(0x203,'KY8I')](/"period":\d*/g,_0x8f45a0(0x1bf,'O86&'))[_0x8f45a0(0x1a5,'78pA')](/"bought_vip":\d*/g,_0x8f45a0(0x1ad,'#0aU'))['replace'](/"bought_vip_end":\d*/g,_0x8f45a0(0x217,'gI4P'))[_0x8f45a0(0x1b6,'rO8b')](/"limitfree":\d*/g,_0x8f45a0(0x1aa,'GHK]'))[_0x8f45a0(0x1df,'R$1l')](/"playable":\d*/g,_0x8f45a0(0x1b3,'jBja'))['replace'](/"downable":\d*/g,_0x8f45a0(0x1f8,'6lH7'))[_0x8f45a0(0x154,'vfqe')](/"playright":\d*/g,_0x8f45a0(0x202,'vfqe'))[_0x8f45a0(0x1fc,'6ajC')](/"downright":\d*/g,_0x8f45a0(0x1ca,'XMwu'))['replace'](/"policytype":\d*/g,_0x8f45a0(0x16a,'@jt&'))[_0x8f45a0(0x186,'@jt&')](/"policy":\d*/g,_0x8f45a0(0x218,'O86&'));continue;}break;}}else{if(/music\.pay/[_0x8f45a0(0x153,'D&Jk')]($request[_0x8f45a0(0x208,'^n))')])){if(method==_0x8f45a0(0x170,'ySfQ')&&$response[_0x8f45a0(0x1da,'^d@y')][_0x8f45a0(0x19f,'@jt&')]('audio')){let obj=JSON[_0x8f45a0(0x195,'bQZm')]($response[_0x8f45a0(0x17f,'#0aU')]);obj[_0x8f45a0(0x155,'XMwu')][0x0]['audio']['forEach'](_0x53259e=>{_0x53259e['st']=0x0;}),$['setval'](obj[_0x8f45a0(0x183,'2F2i')][0x0]['id'][_0x8f45a0(0x1d7,'O86&')](),_0x8f45a0(0x1b9,'gI4P'));let audio=obj[_0x8f45a0(0x190,'^d@y')][0x0]['audio'][0x0];obj[_0x8f45a0(0x166,'DBpK')][0x0]={'info':obj['songs'][0x0],'id':obj[_0x8f45a0(0x205,'iMOc')][0x0]['id'],'pid':audio['pid'],'price':audio[_0x8f45a0(0x159,'1g43')],'type':audio[_0x8f45a0(0x16b,'KY8I')],'name':audio['policy']+'_1','categray':audio[_0x8f45a0(0x1c3,'73oH')]+'_1','order':0x1666118f,'final':[],'buy':0x62ca4da9,'begin':0x62ca4da9,'end':0xf92a65a9,'CurEnd':0x0,'playCnt':0x0,'playUpper':0x12c,'downCnt':0x0,'downUpper':0x12c,'playVideoCnt':0x0,'playVideoUpper':0xbb8,'downVideoCnt':0x0,'downVideoUpper':0xbb8,'period':0x3e8,'feetype':0x0},body=JSON['stringify'](obj);}}else{if($request['url'][_0x8f45a0(0x20f,'iMOc')](_0x8f45a0(0x1bb,'q@y%'))!=-0x1){var body=$response['body'];body=$response['body'][_0x8f45a0(0x1f7,'fhc*')](/<ad[^>]*>/g,'')[_0x8f45a0(0x1ae,'O86&')](/(<userinfolabel)[^>]*>/g,_0x8f45a0(0x1c1,'u!Q%'));}else{if($request['url'][_0x8f45a0(0x212,'^n))')](_0x8f45a0(0x20e,'73oH'))!=-0x1){var body=$response[_0x8f45a0(0x1f9,'bQZm')];body=$response['body'][_0x8f45a0(0x1fc,'6ajC')](/<ad[^>]*>/g,'')[_0x8f45a0(0x1e2,'DiJ5')](/(<userinfolabel)[^>]*>/g,_0x8f45a0(0x15f,'rO8b'));}else{if($request[_0x8f45a0(0x182,'WtTg')][_0x8f45a0(0x150,'YHH)')](_0x8f45a0(0x1a9,'JmJV'))!=-0x1){var body=$response[_0x8f45a0(0x173,'R$1l')],ddgksf2013={'content':[{'query_word':'搜索','desc':''}]};body=JSON[_0x8f45a0(0x1e9,'GHK]')](ddgksf2013);}else{if($request['url'][_0x8f45a0(0x14c,'&Nd1')](_0x8f45a0(0x1f3,'fI]q'))!=-0x1){var body=$response[_0x8f45a0(0x1bc,'DBpK')],ddgksf2013=JSON[_0x8f45a0(0x1f1,'50uK')](body);ddgksf2013[_0x8f45a0(0x16f,'ySfQ')]['list']=Object[_0x8f45a0(0x17d,'fI]q')](ddgksf2013[_0x8f45a0(0x1a6,'D&Jk')][_0x8f45a0(0x1d0,'rO8b')])[_0x8f45a0(0x1e7,'@jt&')](_0x113a62=>{var _0x430020=_0x8f45a0;if(_0x113a62[_0x430020(0x1ce,'Ab76')][_0x430020(0x162,'jBja')]('卡'))return![];else return!![];}),body=JSON['stringify'](ddgksf2013);}else{if($request[_0x8f45a0(0x1c0,'vfqe')][_0x8f45a0(0x15e,'R)6B')]('kuwopay/vip-tab/page/cells')!=-0x1){var body=$response[_0x8f45a0(0x168,'rO8b')],ddgksf2013=JSON[_0x8f45a0(0x1a4,'2F2i')](body);ddgksf2013[_0x8f45a0(0x21e,'*ja7')]=Object[_0x8f45a0(0x1e8,'78pA')](ddgksf2013[_0x8f45a0(0x220,'xB6x')])['filter'](_0x1dfd9d=>{var _0x1929ca=_0x8f45a0,_0x3336ed={'noSCs':_0x1929ca(0x1e4,'rO8b'),'ZcvLH':function(_0x6e12d1,_0xdbacf2){return _0x6e12d1!=_0xdbacf2;},'eQQsK':_0x1929ca(0x214,'gI4P')};if(_0x1dfd9d[_0x1929ca(0x1b7,'&Nd1')]!=_0x3336ed['noSCs']&&_0x3336ed['ZcvLH'](_0x1dfd9d['type'],_0x1929ca(0x216,'R)6B')))return!![];else{if(_0x3336ed[_0x1929ca(0x1a8,'^n))')]!==_0x3336ed[_0x1929ca(0x196,'NWpK')]){var _0x3e3719=_0x54403e['body'],_0x3fa2bf={'content':[{'query_word':'搜索','desc':''}]};_0x3e3719=_0x29cb31[_0x1929ca(0x210,'DBpK')](_0x3fa2bf);}else return![];}});if(ddgksf2013[_0x8f45a0(0x223,'vfqe')]&&ddgksf2013[_0x8f45a0(0x19d,'67Z3')][0x0]?.[_0x8f45a0(0x20c,'*ja7')]==_0x8f45a0(0x1a0,'u!Q%'))ddgksf2013[_0x8f45a0(0x17e,'DiJ5')][0x0][_0x8f45a0(0x1fe,'KY8I')][_0x8f45a0(0x157,'fI]q')]=[_0x8f45a0(0x1d4,'67Z3')];body=JSON[_0x8f45a0(0x1b8,'gI4P')](ddgksf2013);}else{if($request[_0x8f45a0(0x17a,'fI]q')]['indexOf'](_0x8f45a0(0x184,'#0aU'))!=-0x1){var body=$response[_0x8f45a0(0x1f5,'TYs!')],ddgksf2013=JSON[_0x8f45a0(0x161,'^d@y')](body);ddgksf2013['data']?.['tab']?.[_0x8f45a0(0x151,'JmJV')]&&(ddgksf2013['data'][_0x8f45a0(0x176,'78pA')][_0x8f45a0(0x221,'iMOc')]=[{'_id':'63bd4b1002539ab74ca789df','title':'会员','type':_0x8f45a0(0x194,'KY8I'),'description':'会员','topics':[{'mainBgColor':_0x8f45a0(0x1b5,'TYs!'),'title':'精选','navId':_0x8f45a0(0x164,'R)6B'),'deputyBgColor':_0x8f45a0(0x1fd,'2F2i'),'url':_0x8f45a0(0x193,'E^dv')}]}]),body=JSON[_0x8f45a0(0x1f6,')tjH')](ddgksf2013);}else{if($request[_0x8f45a0(0x20b,'DBpK')][_0x8f45a0(0x1ea,'GHK]')](_0x8f45a0(0x169,'6ajC'))!=-0x1){var body=$response['body'];body=body[_0x8f45a0(0x1a7,'TYs!')](/"url"/g,_0x8f45a0(0x171,'78pA'))[_0x8f45a0(0x187,'JmJV')](/last_time":\d+/g,_0x8f45a0(0x179,'50uK'));}else{if(/vip\/v2\/theme/['test']($request['url'])){var body=$response[_0x8f45a0(0x1ee,'iivQ')];let obj=JSON['parse'](body);obj['data'][_0x8f45a0(0x15b,'ss1P')]['type']='free',obj['data'][_0x8f45a0(0x1a3,'XMwu')]=[],body=JSON['stringify'](obj);}else{if(/vip\/v2\/userbase\/vip/[_0x8f45a0(0x1b0,'S6Rz')]($request[_0x8f45a0(0x224,'Ex7[')])){var body=$response[_0x8f45a0(0x180,'u!Q%')];let obj=JSON[_0x8f45a0(0x1c5,'73oH')](body);obj['data']?.[_0x8f45a0(0x181,'u!Q%')]&&(obj[_0x8f45a0(0x18c,'GHK]')][_0x8f45a0(0x17b,')tjH')]={'vipIcon':'https://image.kuwo.cn/fe/f2d09ac0-b959-404f-86fa-dc65c715c0e96.png','iconJumpUrl':'http://vip1.kuwo.cn/vip/vue/anPay/pay/index.html?pageType=avip&MBOX_WEBCLOSE=1&FULLHASARROW=1','growthValue':'21600','vipTag':_0x8f45a0(0x15d,'67Z3'),'vipOverSeasExpire':'0','time':'4000000000000','goSvipPage':'1','isNewUser':'1','vipmIcon':_0x8f45a0(0x1c7,'O86&'),'svipIcon':'https://image.kuwo.cn/fe/f2d09ac0-b959-404f-86fa-dc65c715c0e96.png','vipmExpire':_0x8f45a0(0x1af,'iivQ'),'biedSong':'0','luxuryIcon':_0x8f45a0(0x1c4,'iivQ'),'userType':'3','isYearUser':'2','vip3Expire':'0','experienceExpire':'0','luxAutoPayUser':'2','biedAlbum':'1','vipLuxuryExpire':_0x8f45a0(0x21f,'E^dv'),'vipmAutoPayUser':'2','svipAutoPayUser':'2','vipExpire':_0x8f45a0(0x1d2,'*ja7'),'svipExpire':_0x8f45a0(0x178,'67Z3')}),obj[_0x8f45a0(0x16f,'ySfQ')]?.['tsui']&&(obj[_0x8f45a0(0x1fe,'KY8I')][_0x8f45a0(0x1de,'wbK$')]='{\x22timestamp\x22:1674205529,\x22packs\x22:{\x22type\x22:0,\x22end\x22:4000000000,\x22period\x22:1,\x22bought_vip\x22:1,\x22bought_vip_end\x22:4000000000},\x22result\x22:\x22ok\x22}'),body=JSON[_0x8f45a0(0x1d9,'R$1l')](obj);}else{if(/vip\/v2\/user\/vip/['test']($request[_0x8f45a0(0x213,'O86&')])){var body=$response[_0x8f45a0(0x225,'NWpK')];let obj=JSON[_0x8f45a0(0x161,'^d@y')]($response[_0x8f45a0(0x21b,'50uK')]);obj['data'][_0x8f45a0(0x17c,'Ex7[')]='2',obj['data']['vipLuxuryExpire']=_0x8f45a0(0x219,'6ajC'),obj[_0x8f45a0(0x1a2,'fhc*')]['time']=_0x8f45a0(0x1ec,'S6Rz'),obj[_0x8f45a0(0x1fe,'KY8I')]['isYearUser']='2',obj[_0x8f45a0(0x18a,'R$1l')]['vipmExpire']=_0x8f45a0(0x165,'#qxy'),obj[_0x8f45a0(0x1e1,'bQZm')][_0x8f45a0(0x1eb,'vfqe')]='4000000000000',obj[_0x8f45a0(0x19e,'Ex7[')]['vipExpire']=_0x8f45a0(0x1dc,'u!Q%'),obj[_0x8f45a0(0x191,'DBpK')][_0x8f45a0(0x15a,'1g43')]='4000000000000',body=JSON['stringify'](obj);}else{if(/v2\/api\/pay\/vip\/extraVipStatus/[_0x8f45a0(0x1e5,'iivQ')]($request[_0x8f45a0(0x16d,'@jt&')])){var body=$response[_0x8f45a0(0x19c,'6lH7')];let obj=JSON['parse'](body);obj[_0x8f45a0(0x1a2,'fhc*')][_0x8f45a0(0x1c9,'Ab76')]=0x1,body=JSON[_0x8f45a0(0x1c8,'wbK$')](obj);}else{if(/music\.pay\?uid=.*/['test']($request[_0x8f45a0(0x156,'6lH7')])){var url=$request[_0x8f45a0(0x1d1,'xB6x')]['replace'](/uid=\d+/g,_0x8f45a0(0x172,'Ab76'));$done({'url':url});}else{if(/vip\/enc\/user/[_0x8f45a0(0x18e,'DBpK')]($request[_0x8f45a0(0x201,'#qxy')])){var body=$response[_0x8f45a0(0x1ee,'iivQ')];body=_0x8f45a0(0x1f4,'2F2i');}else;}}}}}}}}}}}}}}}$request['url'][_0x8f45a0(0x198,'E^dv')](_0x8f45a0(0x163,'&Nd1'))==-0x1&&$[_0x8f45a0(0x1f2,'KY8I')]({'body':body});var version_ = 'jsjiami.com.v7';
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e)} isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = [""]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }